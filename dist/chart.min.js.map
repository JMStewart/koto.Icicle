{"version":3,"file":"chart.js","sources":["chart.js","/source/chart.js"],"names":["global","factory","exports","module","require","define","amd","koto","Icicle","d3","this","hierarchy","keySetter","depth","d","map","mapType","array","maxLength","rollup","call","nest","sortValues","sort","keyValue","object","setter","size","values","i","n","length","key","valuesByKey","filter","get","push","set","Object","keys","forEach","entries","sortKey","sortKeys","keyMap","name","children","a","b","newMaxLength","f","order","Tooltip","_koto$Base","selection","getTopLocationsAndPath","tooltipPositionObj","containerWidth","path","translate","translateX","translateY","getPathTranslate","hittingRight","hittingLeft","offsetX","_Chart","config","topY","_topPath","_moveX","updateCaretPath","getRightPositionAndPath","containerHeight","hittingBottom","hittingTop","centerY","rightX","_rightPath","_moveY","getBottomPositionAndPath","bottomY","_bottomPath","getLeftPositionAndPath","leftX","_leftPath","calPositionAndPath","location","positionAndPath","determineInboundsTooltipLocation","closeToTop","closeToRight","closeToLeft","closeToBottom","getTooltipPositionStatus","point","rectBBox","_gBBox","offsetY","y","_baseGroupBBox","height","x","width","offsetPadding","_caretWidth","setBaseGroupBBoxDimensions","isTextRectText","appends","returnVal","node","childNodes","nodeName","formatAppendTextRectText","padding","prevWidth","groupBBox","select","attr","getBBox","element","dy","getCentralPosition","selectAll","transform","setBaseGroupBBox","cloneBBox","_baseGroup","setGBBox","undefined","_appends","elem","parseInt","style","hittingEdge1","hittingEdge2","offset","dimension","heightOrWidth","r","axis","pathString","xyString","caretX","caretY","match","replace","offsetCaretAtEdge","tooltipWidth","tooltipHeight","bboxWidth","bboxHeight","container","mouseXOffset","mouseYOffset","curvedRectOffset","farthestCaretPosition","left","right","top","bottom","generatePaths","w","h","c","box","_get","getPrototypeOf","prototype","configs","base","opacity","caretSize","stationary","maxWidth","format","tooltipBackgroundColor","value","formats","default","text","textBBox","textBlock","textElement","getBoundingClientRect","domoStrings","wrapText","textRectText","append","_parent","parentNode","_drawn","on","contains","removeChild","appendChild","_container","_containerBBox","newWidth","newHeight","baseGroup","posAndPathObj","Base","_Tooltip","_hierarchy","_koto$Base2","click","domain","dx","range","_group","transition","duration","_targetData","textLength","isRelated","thing","relative","isChild","isParent","_x2","_x3","parent","getParent","_x4","_x5","rootName","description","type","units","category","getter","console","log","newValue","item","accessor","percent","overUnder","scale","linear","color","ordinal","partition","layout","_tooltip","_tooltipValue","_tooltipRect","_tooltipLabel","trigger","icicle","layer","dataBind","data","root","target","insert","datum","_tooltipRect2","_tooltipLabel2","coordinates","mouse","_d","symbol","svg","gen","totalDuration","max","ease","delay","shouldShow","canFit","getComputedTextLength","row","level1","child","chart"],"mappings":"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","sourceRoot":"/source/","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('d3'), require('koto')) :\n  typeof define === 'function' && define.amd ? define(['d3', 'koto'], factory) :\n  global.koto.Icicle = factory(global.d3, global.koto)\n}(this, function (d3, koto) { 'use strict';\n\n  class Tooltip extends koto.Base {\n    constructor(selection){\n      super(selection);\n       var _Chart = this;\n       \n       var configs = {\n        container: this.base,\n        opacity: 0,\n        padding: 7,\n        caretSize: 5,\n        stationary: false,\n        maxWidth: 200,\n        format: 'default',\n        tooltipBackgroundColor: '#fff'\n       };\n\n       for (var key in configs) {\n        this.configs.set(key, {value: configs[key]});\n       }\n\n       var formats = {\n        default: function (appends) {},\n        text: function (appends) {\n          //Automatically position if there is only one text element appended\n          if (appends[0].length === 1 && appends.node().childNodes[0].nodeName === 'text') {\n\n            var textBBox = appends.node().childNodes[0].getBBox();\n\n            appends.select('text')\n              .attr({\n                dy: function () { return getCentralPosition(this); },\n                y: textBBox.height / 2\n              });\n            appends.selectAll('tspan')\n              .attr({\n                dy: function () { return getCentralPosition(this); },\n                y: textBBox.height / 2\n              });\n          }\n        },\n        textBlock: function (appends) {\n\n          var textElement = appends.select('text');\n          var dy = textElement.node().getBoundingClientRect().height;\n          d3.domoStrings.wrapText(textElement, _Chart.config('maxWidth'));\n\n          appends.select('text').attr({y: dy - (dy / 4)});\n        },\n        textRectText: function (appends) {\n          //Automatically format for text rect text pattern\n          if (appends.node().childNodes.length % 2 !== 0) {\n\n            if (isTextRectText(appends)) {\n              formatAppendTextRectText(appends);\n            }\n\n          }\n        }\n      };\n\n      var r = 3; //Radius to round the rect\n\n      this._baseGroup = this.base.append('g')\n        .attr('transform', 'translate(0, 0)')\n        .style('pointer-events', 'none');\n\n      _Chart._parent = _Chart._baseGroup.node().parentNode;\n\n      this._baseGroup.append('path')\n        .attr('class', 'toolTipPath')\n        .style('opacity', 0.9);\n\n      this._appends = this._baseGroup.append('g');\n\n      _Chart._drawn = false;\n      _Chart._moveX = undefined;\n      _Chart._moveY = undefined;\n\n      /**\n         * This will hide the tooltip properly\n         */\n        this.on('remove', function () {\n          _Chart._drawn = false;\n\n          if (d3.select('html').node().contains(_Chart._baseGroup.node())) {\n            _Chart._parent.removeChild(_Chart._baseGroup.node());\n          }\n        });\n\n\n\n        /**\n         * This will re-draw the tool tip with the correct dimensions around the _appends group\n         * @param  {number} width  override the width of the container\n         * @param  {number} height  override the height of the container\n         */\n        this.on('draw', function (width, height) {\n          _Chart._parent.appendChild(_Chart._baseGroup.node());\n\n          _Chart._container = _Chart.config('container');\n          _Chart._caretWidth = _Chart.config('caretSize') * 2;\n          _Chart._containerBBox = _Chart.config('container').node().getBoundingClientRect();\n\n          //Format\n          _Chart._baseGroup.select('.toolTipPath').style('fill', _Chart.config('tooltipBackgroundColor'));\n          _Chart._appends.attr('transform', 'translate(' + _Chart.config('padding') + ', ' + _Chart.config('padding') + ')');\n          formats[_Chart.config('format')](_Chart._appends);\n\n          setGBBox(height, width);\n          setBaseGroupBBox();\n          generatePaths();\n\n          _Chart._baseGroup\n            .select('.toolTipPath')\n            .attr({\n              'transform': _Chart._topPath.translate,\n              d: _Chart._topPath.path\n            });\n\n          _Chart._drawn = true;\n        });\n\n\n\n        /**\n         * This will move the tooltip wherever you will it to be\n         * @param  {object} point     Object with an x and y\n         * @param  {string} location  String that will overide the location of the tooltip\n         * @param  {number} newWidth  This will override the width of the tooltip's bounds\n         * @param  {number} newHeight This will override the height of the tooltip's bounds\n         */\n        this.on('moveTo', function (point, location, newWidth, newHeight) {\n          setBaseGroupBBoxDimensions(location);\n\n          if (_Chart._drawn) {\n\n            var containerWidth = newWidth ? newWidth : _Chart._containerBBox.width;\n            var containerHeight = newHeight ? newHeight : _Chart._containerBBox.height;\n            var baseGroup = _Chart._baseGroup;\n            var tooltipPositionObj = getTooltipPositionStatus(containerWidth, containerHeight, point);\n\n            if (!location) {\n              location = determineInboundsTooltipLocation(tooltipPositionObj);\n            }\n\n            offsetCaretAtEdge({\n              left: tooltipPositionObj.hittingLeft,\n              right: tooltipPositionObj.hittingRight,\n              top: tooltipPositionObj.hittingTop,\n              bottom: tooltipPositionObj.hittingBottom,\n              container: {\n                height: containerHeight,\n                width: containerWidth\n              },\n              point: point\n            });\n\n            var posAndPathObj = calPositionAndPath(location, tooltipPositionObj, containerHeight, containerWidth);\n\n            baseGroup.attr('transform', 'translate(' + posAndPathObj.translateX + ',' + posAndPathObj.translateY + ')');\n\n            baseGroup\n              .select('.toolTipPath')\n              .attr({\n                'transform': posAndPathObj.translate,\n                d: posAndPathObj.path\n              });\n          }\n\n        });\n\n\n        /*----------------------------------------------------------------------------------\n        // MoveTo Helper Functions\n        ----------------------------------------------------------------------------------*/\n\n        /**\n         * getTopLocationsAndPath\n         */\n        function getTopLocationsAndPath(tooltipPositionObj, containerWidth) {\n\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateX = getPathTranslate(\n            tooltipPositionObj.hittingRight,\n            tooltipPositionObj.hittingLeft,\n            (tooltipPositionObj.offsetX + (_Chart.config('caretSize'))),\n            'width',\n            containerWidth\n          );\n\n          translateY = tooltipPositionObj.topY;\n          translate = _Chart._topPath.translate;\n\n          if (_Chart._moveX !== 0) {\n            path = updateCaretPath('_topPath', 'x');\n          }\n          else {\n            path = _Chart._topPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n\n        /**\n         * getRightPositionAndPath\n         */\n        function getRightPositionAndPath(tooltipPositionObj, containerHeight) {\n\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateY = getPathTranslate(\n            tooltipPositionObj.hittingBottom,\n            tooltipPositionObj.hittingTop,\n            (tooltipPositionObj.centerY - _Chart.config('padding')),\n            'height',\n            containerHeight\n          );\n\n          translateX = tooltipPositionObj.rightX;\n          translate = _Chart._rightPath.translate;\n\n          if (_Chart._moveY !== 0) {\n            path = updateCaretPath('_rightPath', 'y');\n          }\n          else {\n            path = _Chart._rightPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n\n        /**\n         * getBottomPositionAndPath\n         */\n        function getBottomPositionAndPath(tooltipPositionObj, containerWidth) {\n\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateX = getPathTranslate(\n            tooltipPositionObj.hittingRight,\n            tooltipPositionObj.hittingLeft,\n            (tooltipPositionObj.offsetX + (_Chart.config('caretSize') / 2)),\n            'width',\n            containerWidth\n          );\n\n          translateY = (tooltipPositionObj.bottomY + _Chart.config('padding')) + 5;\n          translate = _Chart._bottomPath.translate;\n\n          if (_Chart._moveX !== 0) {\n            path = updateCaretPath('_bottomPath', 'x');\n          }\n          else {\n            path = _Chart._bottomPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n        /**\n        * getLeftPositionAndPath\n        */\n        function getLeftPositionAndPath (tooltipPositionObj, containerHeight)\n        {\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateY = getPathTranslate(\n            tooltipPositionObj.hittingBottom,\n            tooltipPositionObj.hittingTop,\n            (tooltipPositionObj.centerY - _Chart.config('padding')),\n            'height',\n            containerHeight\n          );\n\n          translateX = tooltipPositionObj.leftX;\n          translate = _Chart._leftPath.translate;\n\n          if (_Chart._moveY !== 0) {\n            path = updateCaretPath('_leftPath', 'y');\n          }\n          else {\n            path = _Chart._leftPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n\n        /**\n         * Returns the tooltips draw position and path given the current draw location.\n         *\n         * @param location\n         * @param tooltipPositionObj\n         * @param containerHeight\n         * @returns {{translateX: *, translateY: *, translate: *, path: *}}\n         */\n        function calPositionAndPath(location, tooltipPositionObj, containerHeight, containerWidth) {\n\n          var positionAndPath;\n\n          switch (location) {\n            case 'top':{\n              positionAndPath = getTopLocationsAndPath(tooltipPositionObj, containerWidth);\n              break;\n            }\n            case 'right': {\n              positionAndPath = getRightPositionAndPath(tooltipPositionObj, containerHeight);\n              break;\n            }\n            case 'bottom': {\n              positionAndPath = getBottomPositionAndPath(tooltipPositionObj, containerWidth);\n              break;\n            }\n            case 'left': {\n              positionAndPath = getLeftPositionAndPath(tooltipPositionObj, containerHeight);\n              break;\n            }\n          }\n\n          return positionAndPath;\n        }\n\n\n        /**\n         * Determine the direction the tooltip should draw given its location.\n         * @param tooltipPositionObj\n         * @returns {string}\n         */\n        function determineInboundsTooltipLocation(tooltipPositionObj) {\n\n          var location = 'top';\n          if ((tooltipPositionObj.hittingRight || tooltipPositionObj.hittingLeft) && !tooltipPositionObj.closeToTop) {\n            location = 'top';\n          }\n          else if ((tooltipPositionObj.hittingRight || tooltipPositionObj.hittingLeft) && tooltipPositionObj.closeToTop) {\n            location = 'bottom';\n          }\n          else if (tooltipPositionObj.hittingTop && tooltipPositionObj.closeToRight) {\n            location = 'left';\n          }\n          else if (tooltipPositionObj.hittingTop && tooltipPositionObj.closeToLeft) {\n            location = 'right';\n          }\n          else if (!tooltipPositionObj.hittingRight && tooltipPositionObj.closeToRight) {\n            location = 'left';\n          }\n          else if (!tooltipPositionObj.hittingLeft && tooltipPositionObj.closeToLeft) {\n            location = 'right';\n          }\n          else if (tooltipPositionObj.closeToBottom && tooltipPositionObj.closeToTop) {\n            location = 'top';\n          }\n          else if (tooltipPositionObj.closeToTop) {\n            location = 'bottom';\n          }\n\n          return location;\n        }\n\n\n        /**\n         * getTooltipPositionStatus\n         */\n        function getTooltipPositionStatus(containerWidth, containerHeight, point) {\n          var rectBBox = _Chart._gBBox;\n\n          var offsetY = point.y - _Chart._baseGroupBBox.height;\n          var offsetX = point.x - _Chart._baseGroupBBox.width / 2;\n          var offsetPadding = _Chart._caretWidth;\n\n          var topY    = offsetY - offsetPadding;\n          var bottomY = point.y + offsetPadding;\n          var centerY = point.y - rectBBox.height / 2;\n          var leftX   = point.x - _Chart._baseGroupBBox.width - _Chart.config('caretSize');\n          var rightX  = point.x + offsetPadding + 5;\n\n          var closeToRight = point.x + _Chart._baseGroupBBox.width / 2 >= containerWidth;\n          var closeToLeft = point.x - _Chart._baseGroupBBox.width / 2 <= 0;\n          var closeToTop = point.y - _Chart._baseGroupBBox.height - offsetPadding - 3 <= 0;\n          var closeToBottom = point.y + _Chart._baseGroupBBox.height > containerHeight;\n\n          var hittingRight  = closeToRight && point.x - _Chart._baseGroupBBox.width - offsetPadding <= 0;\n          var hittingLeft   = closeToLeft && point.x + _Chart._baseGroupBBox.width + offsetPadding >= containerWidth;\n          var hittingTop    = (closeToRight || closeToLeft) && (point.y - (_Chart._baseGroupBBox.height / 2) <= 0);\n          var hittingBottom = (closeToRight || closeToLeft) && (point.y + (_Chart._baseGroupBBox.height / 2) >= containerHeight);\n\n          return {\n            offsetX: offsetX,\n            topY: topY,\n            bottomY: bottomY,\n            centerY: centerY,\n            leftX: leftX,\n            rightX: rightX,\n            closeToRight: closeToRight,\n            closeToLeft: closeToLeft,\n            closeToTop: closeToTop,\n            closeToBottom: closeToBottom,\n            hittingRight: hittingRight,\n            hittingLeft: hittingLeft,\n            hittingTop: hittingTop,\n            hittingBottom: hittingBottom\n          };\n        }\n\n\n        /**\n         * SetBaseGroupBBoxDimensions\n         * @param location position of the tooltip\n         */\n        function setBaseGroupBBoxDimensions(location) {\n          _Chart._baseGroupBBox.height =\n            location === 'top' || location === 'bottom' ?\n            _Chart._gBBox.height + (_Chart.config('padding') * 2) + _Chart.config('caretSize') + 6 :\n            _Chart._gBBox.height + (_Chart.config('padding') * 2) + 6;\n\n          _Chart._baseGroupBBox.width =\n            location === 'top' || location === 'bottom' ?\n            _Chart._gBBox.width + (_Chart.config('padding') * 2) + 6 :\n            _Chart._gBBox.width + (_Chart.config('padding') * 2) + _Chart.config('caretSize') + 6;\n        }\n\n\n\n\n\n        /*----------------------------------------------------------------------------------\n        // Helper Functions\n        ----------------------------------------------------------------------------------*/\n\n        /**\n         * Returns if appends is in text rect text format\n         * @param appends\n         * @returns {boolean}\n         */\n        function isTextRectText(appends) {\n          var returnVal = true;\n          for (var i = 0; i < appends.node().childNodes.length; i++) {\n            var nodeName = appends.node().childNodes[i].nodeName;\n            returnVal = (i % 2 === 0 && nodeName === 'text' ? true : (nodeName === 'rect'));\n            if (!returnVal) { break;}\n          }\n          return returnVal;\n        }\n\n        /**\n         * Formats appends as text rect text\n         * @param appends\n         * @param groupBBox\n         */\n        function formatAppendTextRectText(appends) {\n          var padding = 5;\n          var prevWidth = 0;\n          var groupBBox = {x:0,y:0,height:0,width:0};\n\n          appends.select('rect').attr('height', 0);\n          groupBBox = appends.node().getBBox();\n\n\n          /*jshint -W083 */\n          for (var i = 0; i < appends.node().childNodes.length; i++) {\n            var element = appends.node().childNodes[i];\n\n            if (i % 2 === 0) {\n              //text\n              var t = appends.select('text:nth-child(' + (i + 1) + ')')\n                .attr({\n                  dy: function () {return getCentralPosition(this);},\n                  x: (prevWidth + (padding * i) + 1),\n                  y: groupBBox.height / 2\n                });\n\n              prevWidth += element.getBBox().width;\n\n            }\n            else {\n              //rect\n              appends.select('rect:nth-child(' + (i + 1) + ')')\n                .attr({\n                  x: (prevWidth + (padding * i)),\n                  y: 0,\n                  width: 1,\n                  height: groupBBox.height\n                });\n            }\n          }\n\n          appends.selectAll('tspan')\n            .attr({\n              transform: function () { return 'translate(0, ' + getCentralPosition(this) + ')'; },\n              y: groupBBox.height / 2\n            });\n        }\n\n\n        /**\n         * setBaseGroupBBox\n         */\n        function setBaseGroupBBox() {\n          _Chart._baseGroupBBox = cloneBBox(_Chart._baseGroup.node().getBBox());\n          _Chart._baseGroupBBox.height = _Chart._baseGroupBBox.height - _Chart._caretWidth + 3;\n        }\n\n\n        /**\n         * Set gBBox's height and width to height, width if defined else\n         * it will use appends BBox.\n         * @param height\n         * @param width\n         */\n        function setGBBox(height, width) {\n          if (height !== undefined && width !== undefined) {\n            _Chart._gBBox = {\n              'height': height,\n              'width': width\n            };\n          }\n          else {\n            _Chart._gBBox = _Chart._appends.node().getBBox();\n          }\n        }\n\n\n        /**\n         * Calculates vertical center for text\n         * @param elem\n         * @returns {number}\n         */\n        function getCentralPosition(elem) {\n          return parseInt(d3.select(elem)\n              .style('font-size'), 10) * 0.35;\n        }\n\n        /**\n         * Returns a tranlate that keeps the path in bounds.\n         * @param hittingEdge1\n         * @param hittingEdge2\n         * @param offset\n         * @param dimension\n         * @param heightOrWidth\n         * @returns {*}\n         */\n        function getPathTranslate(hittingEdge1, hittingEdge2, offset, dimension, heightOrWidth) {\n          var translate;\n\n          if (hittingEdge1) {\n            translate = heightOrWidth - _Chart._baseGroupBBox[dimension] + r;\n          }\n          else if (hittingEdge2) {\n            translate = r;\n          }\n          else {\n            translate = offset;\n          }\n\n          return translate;\n        }\n\n        /**\n         * UpdateCaretPath\n         * @param path\n         * @param axis\n         * @returns {.autoshot.default_options.options.path|*|.autoshot.default_options.options.local.path|options.path|options.local.path|path}\n         */\n        function updateCaretPath(path, axis) {\n          var pathString;\n          var xyString;\n\n          if (axis === 'y') {\n            xyString = _Chart[path].caretX + ' ' + (_Chart[path].caretY - _Chart._moveY);\n          }\n          else {\n            xyString = (_Chart[path].caretX + _Chart._moveX) + ' ' + _Chart[path].caretY;\n          }\n\n          pathString = _Chart[path].path.match(/Z m (.*?) l/);\n          _Chart[path].path = _Chart[path].path.replace(pathString[1], xyString);\n          return _Chart[path].path;\n        }\n\n\n        /**\n         * OffsetCaretAtEdge\n         * @param config\n         */\n        function offsetCaretAtEdge(config) {\n          var container = config.container;\n          var point = config.point;\n          var tooltipWidth;\n          var tooltipHeight;\n          var bboxWidth;\n          var bboxHeight;\n          var mouseXOffset = container.width - point.x;\n          var mouseYOffset = point.y;\n\n          var curvedRectOffset = 2*r; //Compensate for the curved rect path. 1 is for good measure.\n\n          bboxHeight = _Chart._gBBox.height; // - curvedRectOffset;\n          bboxWidth  = _Chart._gBBox.width; //  - curvedRectOffset;\n\n\n          var farthestCaretPosition;\n\n          if (config.left || config.right) {\n\n            //Left\n            if (config.left) {\n              tooltipWidth = container.width - (_Chart._baseGroupBBox.width / 2);\n              _Chart._moveX = tooltipWidth - mouseXOffset;\n\n              if ((bboxWidth / 2) + _Chart.config('caretSize') <= _Chart._moveX) {\n                _Chart._moveX = -((bboxWidth / 2) + _Chart.config('caretSize'));\n              }\n            }\n\n            //Right\n            if (config.right) {\n              tooltipWidth = _Chart._baseGroupBBox.width / 2;\n              _Chart._moveX = tooltipWidth - mouseXOffset;\n\n              if (-((bboxWidth / 2) + _Chart.config('caretSize')) >= _Chart._moveX) {\n                _Chart._moveX = -((bboxWidth / 2) + _Chart.config('caretSize'));\n              }\n            }\n\n\n          }\n          else if (config.top || config.bottom) {\n\n            //Top\n            if (config.top) {\n              tooltipHeight = _Chart._baseGroupBBox.height / 2;\n              _Chart._moveY = tooltipHeight - mouseYOffset;\n\n              farthestCaretPosition = (bboxHeight / 2) + _Chart.config('caretSize') - curvedRectOffset;\n\n              if (farthestCaretPosition <= _Chart._moveY) {\n                _Chart._moveY = farthestCaretPosition;\n              }\n            }\n\n            //Bottom\n            if (config.bottom) {\n              tooltipHeight = container.height - ((_Chart._baseGroupBBox.height) / 2);\n              _Chart._moveY = tooltipHeight - mouseYOffset;\n\n              farthestCaretPosition = -(((bboxHeight) / 2) - _Chart.config('caretSize')) - curvedRectOffset;\n\n              if (farthestCaretPosition >= _Chart._moveY) {\n                _Chart._moveY = farthestCaretPosition;\n              }\n            }\n          }\n          else {\n            _Chart._moveX = 0;\n            _Chart._moveY = 0;\n          }\n        }\n\n\n        /**\n         * GeneratePaths\n         */\n        function generatePaths() {\n          var w = _Chart._gBBox.width + (_Chart.config('padding') * 2);\n          var h = _Chart._gBBox.height + (_Chart.config('padding') * 2);\n          var c = _Chart.config('caretSize');\n          var y = (h / 2) + _Chart.config('caretSize') + r;\n\n          _Chart._topPath = {\n            translate: 'translate(' + (w / 2) + ',' + (h + c + r) + ')',\n            caretX: ((w / 2) - c),\n            caretY: (h + (r * 2))\n          };\n          _Chart._topPath.path = 'm -' + (w / 2) + ' -' + (h + c + (r * 2)) +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._topPath.caretX + ' ' + _Chart._topPath.caretY +\n          ' l ' + c + ' ' + c +\n          ' l ' + c + ' -' + c;\n\n          _Chart._bottomPath = {\n            translate: 'translate(' + (w / 2) + ',' + (-c + (r / 2)) + ')',\n            caretX: ((w / 2) - c),\n            caretY: 0\n          };\n          _Chart._bottomPath.path = 'm -' + (w / 2) + ' ' + 0 +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._bottomPath.caretX + ' ' + _Chart._bottomPath.caretY +\n          ' l ' + c + ' -' + c +\n          ' l ' + c + ' ' + c;\n\n          _Chart._leftPath = {\n            translate: 'translate(' + (w + c + r) + ',' + (h / 2) + ')',\n            caretX: (w + r),\n            caretY: y\n          };\n          _Chart._leftPath.path = 'm -' + (w + c + r) + ' ' + -((h / 2) + r) +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._leftPath.caretX + ' ' + _Chart._leftPath.caretY +\n          ' l ' + c + ' -' + c +\n          ' l -' + c + ' -' + c;\n\n          _Chart._rightPath = {\n            translate: 'translate(' + -(c + r) + ',' + (h / 2) + ')',\n            caretX: -r,\n            caretY: y\n          };\n          _Chart._rightPath.path = 'm ' + (c + r) + ' ' + -((h / 2) + r) +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._rightPath.caretX + ' ' + _Chart._rightPath.caretY +\n          ' l -' + c + ' -' + c +\n          ' l ' + c + ' -' + c + ' Z';\n        }\n\n        /**\n         * cloneBBox, IE will not let you modify the obj returned from getBBox\n         * @param box\n         * @returns {{x: *, y: *, width: *, height: *}}\n         */\n        function cloneBBox(box) {\n          return {\n            x: box.x,\n            y: box.y,\n            width: box.width,\n            height: box.height\n          };\n        }\n    }\n    preDraw(){\n      this._container = this.config('container');\n    }\n  }\n\n  var _Tooltip = Tooltip;\n\n  /**\n   * This will convert a flat, 2D array into a nested data structure.\n   * Simular to d3.nest but allows n number of depths for each node\n   */\n\n  // jscs:disable\n  function hierarchy () {\n    var nest = {},\n        keys = [],\n        sortKeys = [],\n        maxLength = 0,\n        sortValues,\n        rollup,\n        filter = function (d) {\n          return d !== null;\n        };\n\n   function keySetter (depth) {\n      return function (d) {\n        return d[depth];\n      };\n    }\n\n    function map(mapType, array, depth) {\n      if (depth >= maxLength) {\n        return rollup\n          ? rollup.call(nest, array) : (sortValues\n          ? array.sort(sortValues)\n          : array);\n      }\n\n      var i = -1,\n          n = array.length,\n          key = keySetter(depth++),\n          keyValue,\n          object,\n          setter,\n          size,\n          valuesByKey = d3.map({}),\n          values;\n\n      /*jshint -W084 */\n      while (++i < n) {\n        if (depth === 1) {\n          object = array[i].filter(filter);\n        } else {\n          object = array[i];\n        }\n        values = valuesByKey.get(keyValue = key(object));\n        if (array[i].length > depth) {\n          if (values) {\n            values.push(object);\n          } else {\n            valuesByKey.set(keyValue, [object]);\n          }\n        }\n      }\n\n      if (mapType) {\n        object = mapType();\n        size = function (object) {\n          return object.size();\n        };\n        setter = function(keyValue, values) {\n          object.set(keyValue, map(mapType, values, depth));\n        };\n      } else {\n        object = {};\n        size = function (object) {\n          return Object.keys(object).length;\n        };\n        setter = function(keyValue, values) {\n          object[keyValue] = map(mapType, values, depth);\n        };\n      }\n\n      valuesByKey.forEach(setter);\n      if (!size(object)) {\n        return array;\n      }\n      return object;\n    }\n\n    function entries(map, depth) {\n      if (depth >= maxLength || depth > map.length - 1) {\n        return map;\n      }\n\n      var array = [],\n          sortKey = sortKeys[depth++];\n\n      map.forEach(function(key, keyMap) {\n        array.push({name: key, children: entries(keyMap, depth)});\n      });\n\n      return sortKey\n        ? array.sort(function(a, b) { return sortKey(a.name, b.name); })\n        : array;\n    }\n\n    nest.map = function(array, mapType) {\n      return map(mapType, array, 0);\n    };\n\n    nest.entries = function(array) {\n      return entries(map(d3.map, array, 0), 0);\n    };\n\n    nest.maxLength = function(newMaxLength) {\n      maxLength = newMaxLength - 2;\n      return nest;\n    };\n\n    nest.filter = function (f) {\n      filter = f;\n      return nest;\n    };\n\n    // Specifies the order for the most-recently specified key.\n    // Note: only applies to entries. Map keys are unordered!\n    nest.sortKeys = function(order, depth) {\n      depth = depth || maxLength;\n      sortKeys[depth] = order;\n      return nest;\n    };\n\n    // Specifies the order for leaf values.\n    // Applies to both maps and entries array.\n    nest.sortValues = function(order) {\n      sortValues = order;\n      return nest;\n    };\n\n    nest.rollup = function(f) {\n      rollup = f;\n      return nest;\n    };\n\n    return nest;\n  }\n  // jscs:enable\n\n  var _hierarchy = hierarchy;\n\n  class Icicle extends koto.Base {\n  \tconstructor(selection) {\n      super(selection);\n      var _Chart = this;\n\n      [{\n        name: 'height',\n        description: 'The height of the chart.',\n        value: 700,\n        type: 'number',\n        units: 'px',\n        category: 'Size',\n        getter: function (){\n          // get value\n          console.log('getter');\n          return this.value;\n        },\n        setter: function (newValue){\n          // Set something\n          console.log('setter');\n          return newValue;\n        }\n      }, {\n        name: 'width',\n        description: 'The widthj of the chart.',\n        value: 900,\n        units: 'px',\n        type: 'number',\n        category: 'Size'\n      }, {\n        name: 'transitionDuration',\n        description: 'How long should it take to animate on click.',\n        value: 750,\n        units: 'ms',\n        type: 'number',\n        category: 'Animation'\n      }, {\n        name: 'introDuration',\n        description: 'How long should it take to animate in.',\n        value: 2000,\n        units: 'ms',\n        type: 'number',\n        category: 'Animation'\n      }, {\n        name: 'colorRange',\n        value: ['#BBE491', '#FB8D34', '#E45621', '#73B0D7'],\n        description: 'colors for categories',\n        type: 'colorArray',\n        category: 'Color'\n      }].forEach(function (item) {\n        _Chart.configs.set(item.name, item);\n      });\n\n      // accessors\n      this.accessor('name', function (d) { return d[d.length-2]; });\n\n      // formatters\n      var percent = d3.format('%');\n      var overUnder = d3.format('+%');\n\n      // scales\n      this.x = d3.scale.linear();\n      this.y = d3.scale.linear();\n      this.color = d3.scale.ordinal();\n\n      // layouts\n      this.partition = d3.layout.partition()\n        .value(function(d) { return d[d.length - 1]; });\n\n      // setup main group\n      this._group = this.base.append('g');\n      \n      // Set up tool tip;\n      this._tooltip = new _Tooltip(this.base.append('g'));\n\n      this._tooltip.config({\n        opacity: 1,\n        format: 'textRectText'\n      });\n\n      this._tooltipValue = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      this._tooltipRect = this._tooltip._appends.append('rect');\n      this._tooltipLabel = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      \n      this._tooltip.trigger('draw');\n      this._tooltip.trigger('remove');\n      \n      // Setup Layers\n      var icicle = this.layer('icicle', this._group, {\n        dataBind: function (data) {\n          var root = _Chart.partition(data[0]);\n          if (_Chart._targetData) {\n            var target = _Chart.partition(_Chart._targetData[0]);\n            for (var i=0; i < root.length; i++) {\n              root[i].target = target[i].value;\n            }\n          }\n          return this.selectAll('g').data(root);\n        },\n        insert: function () {\n          return this.append('g')\n            .on('click', click)\n            .on('mouseover', function (d) {\n              _Chart._group.selectAll('rect')\n                .filter(function (datum) {\n                  var thingName = d.name ? d.name : d[d.length - 2];\n                  return !isRelated(d, datum);\n                })\n                .style('fill', '#e3e3e3');\n\n                _Chart._tooltipValue\n                  .text(d.name ? d.name : _Chart.accessor('name')(d));\n\n                _Chart._tooltipRect.style('fill', '#000');\n\n                _Chart._tooltipLabel\n                  .text(percent(d.value));\n\n                if (_Chart._targetData) {\n                  _Chart._tooltipRect2.style('fill', '#000');\n                  _Chart._tooltipLabel2\n                    .text(overUnder(d.value - d.target));\n                }\n\n                _Chart._tooltip.trigger('draw');\n              })\n              .on('mousemove', function () {\n                var coordinates = d3.mouse(_Chart.base.node());\n                _Chart._tooltip.trigger('moveTo', {x: coordinates[0], y: coordinates[1]}, null, _Chart.config('width'), _Chart.config('height'));\n              })\n              .on('mouseout', function (d) {\n                _Chart._group.selectAll('rect')\n                  .style('fill', function(d) { return _Chart.color(d.base); });\n\n                _Chart._tooltip.trigger('remove');\n              });\n        }\n      });\n    \n      // layer life-cycle events\n      icicle.on('enter', function () {\n        this.append('rect')\n          .style('stroke', '#fff');\n        \n        if (_Chart._targetData) {\n          this.append('path');\n        }\n\n        this.append('text')\n          .style('pointer-events', 'none');\n\n        return this;\n      })\n      .on('merge', function () {\n        // boxes\n        this.selectAll('rect')\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.dx); })\n          .attr('height', 0)\n          .style('fill', function(d) { d.base = getParent(d, _Chart.rootName); return _Chart.color(d.base); });\n\n        // over-under indicator\n        if (_Chart._targetData) {\n          this.selectAll('path')\n            .style('fill', '#555')\n            .style('opacity', 0)\n            .attr({\n              d: function (d) {\n                var symbol = d3.svg.symbol();\n                var gen = d.value > d.target ? symbol.type('triangle-up') : d.value < d.target ? symbol.type('triangle-down') : symbol.type('triangle-down');\n                return gen();\n              },\n              transform: function (d) {\n                var left = _Chart.x(d.x) + 15;\n                var top = _Chart.y(d.y) + 15;\n                \n                return `translate(${left},${top})`;\n              }\n            });\n        }\n\n        // labels\n        this.selectAll('text')\n          .text(function (d) { return d.name ? d.name : d[d.length - 2]; })\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('dx', _Chart._targetData ? 25 : 5)\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('dy', 16)\n          .style('alignment-baseline', 'middle')\n          .style('fill', '#555')\n          .style('font-family', 'Open Sans')\n          .style('opacity', 0);\n      })\n      .on('merge:transition', function () {\n        var totalDuration = _Chart.config('introDuration');\n        var duration = totalDuration/(_Chart.max-1);\n        \n        // rects\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .selectAll('rect')\n          .attr('height', function(d) { return _Chart.y(d.dy); });\n        \n        // paths\n        if (_Chart._targetData) {\n          this\n            .delay(totalDuration)\n            .selectAll('path')\n            .style('opacity', function (d) {\n              var shouldShow = d.value > d.target || d.value < d.target;\n              var canFit = _Chart.x(d.dx) > 25;\n              return shouldShow && canFit ? 1 : 0;\n            });\n        }\n\n        // linear\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .selectAll('text')\n          .style('opacity', function (d) {\n            d.textLength = this.getComputedTextLength();\n            return (d.textLength + 30) < _Chart.x(d.dx) ? 1 : 0;\n          });\n        return this;\n      });\n\n      // click event handler\n      function click(d) {\n        _Chart.x.domain([d.x, d.x + d.dx]);\n        _Chart.y.domain([d.y, 1]).range([d.y ? 20 : 0, _Chart.config('height')]);\n\n        // transition Rects\n        _Chart._group.selectAll('rect')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.x + d.dx) - _Chart.x(d.x); })\n          .attr('height', function(d) { return _Chart.y(d.y + d.dy) - _Chart.y(d.y); });\n\n        // transition paths\n        if (_Chart._targetData) {\n          _Chart._group.selectAll('path')\n            .transition()\n            .duration(_Chart.config('transitionDuration'))\n            .attr('transform', function (d) {\n              var left = _Chart.x(d.x) + 15;\n              var top = _Chart.y(d.y) + 15;\n              return `translate(${left},${top})`;\n            });\n        }\n\n        // transition text\n        _Chart._group.selectAll('text')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .style('opacity', function (d) {\n            return (d.textLength + 12) < (_Chart.x(d.x + d.dx) - _Chart.x(d.x)) ? 1 : 0;\n          });\n      }\n\n      // check to see if nodes are related\n      function isRelated(thing, relative) {\n        return (isChild(thing, relative) || isParent(thing, relative));\n      }\n\n      // check to see if node is child\n      function isChild(thing, relative) {\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.parent) {\n          return false;\n        }\n        return isChild(thing.parent, relative);\n      }\n\n      // check to see if node is parent\n      function isParent (thing, relative) {\n        var i;\n        var temp;\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.children) {\n          return false;\n        }\n        for (i=0; i < thing.children.length; i++) {\n          if (isParent(thing.children[i], relative)) {\n            return true;\n          }\n        }\n        return false;\n      }\n\n      // get parents name - for color\n      function getParent (d, rootName) {\n        if (!d.parent) {\n          return d.name;\n        }\n        if (d.parent.name === rootName) {\n          return d.name;\n        }\n        return getParent(d.parent, rootName);\n      }\n    }\n\n    transform(data){\n      this.max = d3.max(data, function (row) { return row.length; });\n      return _hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n    }\n\n    targetData(data){\n      this._targetData = _hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n\n      this._tooltipRect2 = this._tooltip._appends.append('rect');\n      this._tooltipLabel2 = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      return this;\n    }\n\n    preDraw(data){\n      this.x.range([0, this.config('width')]);\n      this.y.range([0, this.config('height')]);\n      this.rootName = data[0].name;\n      \n      var level1 = data[0].children.map(function (child) { return child.name; });\n      level1.push(this.rootName);\n      this.color.range(this.config('colorRange')).domain(level1);\n    }\n  }\n\n  koto.Icicle = Icicle;\n\n  var chart = koto.Icicle;\n\n  return chart;\n\n}));\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('d3'), require('koto')) :\n  typeof define === 'function' && define.amd ? define(['d3', 'koto'], factory) :\n  global.koto.Icicle = factory(global.d3, global.koto)\n}(this, function (d3, koto) { 'use strict';\n\n  class Tooltip extends koto.Base {\n    constructor(selection){\n      super(selection);\n       var _Chart = this;\n       \n       var configs = {\n        container: this.base,\n        opacity: 0,\n        padding: 7,\n        caretSize: 5,\n        stationary: false,\n        maxWidth: 200,\n        format: 'default',\n        tooltipBackgroundColor: '#fff'\n       };\n\n       for (var key in configs) {\n        this.configs.set(key, {value: configs[key]});\n       }\n\n       var formats = {\n        default: function (appends) {},\n        text: function (appends) {\n          //Automatically position if there is only one text element appended\n          if (appends[0].length === 1 && appends.node().childNodes[0].nodeName === 'text') {\n\n            var textBBox = appends.node().childNodes[0].getBBox();\n\n            appends.select('text')\n              .attr({\n                dy: function () { return getCentralPosition(this); },\n                y: textBBox.height / 2\n              });\n            appends.selectAll('tspan')\n              .attr({\n                dy: function () { return getCentralPosition(this); },\n                y: textBBox.height / 2\n              });\n          }\n        },\n        textBlock: function (appends) {\n\n          var textElement = appends.select('text');\n          var dy = textElement.node().getBoundingClientRect().height;\n          d3.domoStrings.wrapText(textElement, _Chart.config('maxWidth'));\n\n          appends.select('text').attr({y: dy - (dy / 4)});\n        },\n        textRectText: function (appends) {\n          //Automatically format for text rect text pattern\n          if (appends.node().childNodes.length % 2 !== 0) {\n\n            if (isTextRectText(appends)) {\n              formatAppendTextRectText(appends);\n            }\n\n          }\n        }\n      };\n\n      var r = 3; //Radius to round the rect\n\n      this._baseGroup = this.base.append('g')\n        .attr('transform', 'translate(0, 0)')\n        .style('pointer-events', 'none');\n\n      _Chart._parent = _Chart._baseGroup.node().parentNode;\n\n      this._baseGroup.append('path')\n        .attr('class', 'toolTipPath')\n        .style('opacity', 0.9);\n\n      this._appends = this._baseGroup.append('g');\n\n      _Chart._drawn = false;\n      _Chart._moveX = undefined;\n      _Chart._moveY = undefined;\n\n      /**\n         * This will hide the tooltip properly\n         */\n        this.on('remove', function () {\n          _Chart._drawn = false;\n\n          if (d3.select('html').node().contains(_Chart._baseGroup.node())) {\n            _Chart._parent.removeChild(_Chart._baseGroup.node());\n          }\n        });\n\n\n\n        /**\n         * This will re-draw the tool tip with the correct dimensions around the _appends group\n         * @param  {number} width  override the width of the container\n         * @param  {number} height  override the height of the container\n         */\n        this.on('draw', function (width, height) {\n          _Chart._parent.appendChild(_Chart._baseGroup.node());\n\n          _Chart._container = _Chart.config('container');\n          _Chart._caretWidth = _Chart.config('caretSize') * 2;\n          _Chart._containerBBox = _Chart.config('container').node().getBoundingClientRect();\n\n          //Format\n          _Chart._baseGroup.select('.toolTipPath').style('fill', _Chart.config('tooltipBackgroundColor'));\n          _Chart._appends.attr('transform', 'translate(' + _Chart.config('padding') + ', ' + _Chart.config('padding') + ')');\n          formats[_Chart.config('format')](_Chart._appends);\n\n          setGBBox(height, width);\n          setBaseGroupBBox();\n          generatePaths();\n\n          _Chart._baseGroup\n            .select('.toolTipPath')\n            .attr({\n              'transform': _Chart._topPath.translate,\n              d: _Chart._topPath.path\n            });\n\n          _Chart._drawn = true;\n        });\n\n\n\n        /**\n         * This will move the tooltip wherever you will it to be\n         * @param  {object} point     Object with an x and y\n         * @param  {string} location  String that will overide the location of the tooltip\n         * @param  {number} newWidth  This will override the width of the tooltip's bounds\n         * @param  {number} newHeight This will override the height of the tooltip's bounds\n         */\n        this.on('moveTo', function (point, location, newWidth, newHeight) {\n          setBaseGroupBBoxDimensions(location);\n\n          if (_Chart._drawn) {\n\n            var containerWidth = newWidth ? newWidth : _Chart._containerBBox.width;\n            var containerHeight = newHeight ? newHeight : _Chart._containerBBox.height;\n            var baseGroup = _Chart._baseGroup;\n            var tooltipPositionObj = getTooltipPositionStatus(containerWidth, containerHeight, point);\n\n            if (!location) {\n              location = determineInboundsTooltipLocation(tooltipPositionObj);\n            }\n\n            offsetCaretAtEdge({\n              left: tooltipPositionObj.hittingLeft,\n              right: tooltipPositionObj.hittingRight,\n              top: tooltipPositionObj.hittingTop,\n              bottom: tooltipPositionObj.hittingBottom,\n              container: {\n                height: containerHeight,\n                width: containerWidth\n              },\n              point: point\n            });\n\n            var posAndPathObj = calPositionAndPath(location, tooltipPositionObj, containerHeight, containerWidth);\n\n            baseGroup.attr('transform', 'translate(' + posAndPathObj.translateX + ',' + posAndPathObj.translateY + ')');\n\n            baseGroup\n              .select('.toolTipPath')\n              .attr({\n                'transform': posAndPathObj.translate,\n                d: posAndPathObj.path\n              });\n          }\n\n        });\n\n\n        /*----------------------------------------------------------------------------------\n        // MoveTo Helper Functions\n        ----------------------------------------------------------------------------------*/\n\n        /**\n         * getTopLocationsAndPath\n         */\n        function getTopLocationsAndPath(tooltipPositionObj, containerWidth) {\n\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateX = getPathTranslate(\n            tooltipPositionObj.hittingRight,\n            tooltipPositionObj.hittingLeft,\n            (tooltipPositionObj.offsetX + (_Chart.config('caretSize'))),\n            'width',\n            containerWidth\n          );\n\n          translateY = tooltipPositionObj.topY;\n          translate = _Chart._topPath.translate;\n\n          if (_Chart._moveX !== 0) {\n            path = updateCaretPath('_topPath', 'x');\n          }\n          else {\n            path = _Chart._topPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n\n        /**\n         * getRightPositionAndPath\n         */\n        function getRightPositionAndPath(tooltipPositionObj, containerHeight) {\n\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateY = getPathTranslate(\n            tooltipPositionObj.hittingBottom,\n            tooltipPositionObj.hittingTop,\n            (tooltipPositionObj.centerY - _Chart.config('padding')),\n            'height',\n            containerHeight\n          );\n\n          translateX = tooltipPositionObj.rightX;\n          translate = _Chart._rightPath.translate;\n\n          if (_Chart._moveY !== 0) {\n            path = updateCaretPath('_rightPath', 'y');\n          }\n          else {\n            path = _Chart._rightPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n\n        /**\n         * getBottomPositionAndPath\n         */\n        function getBottomPositionAndPath(tooltipPositionObj, containerWidth) {\n\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateX = getPathTranslate(\n            tooltipPositionObj.hittingRight,\n            tooltipPositionObj.hittingLeft,\n            (tooltipPositionObj.offsetX + (_Chart.config('caretSize') / 2)),\n            'width',\n            containerWidth\n          );\n\n          translateY = (tooltipPositionObj.bottomY + _Chart.config('padding')) + 5;\n          translate = _Chart._bottomPath.translate;\n\n          if (_Chart._moveX !== 0) {\n            path = updateCaretPath('_bottomPath', 'x');\n          }\n          else {\n            path = _Chart._bottomPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n        /**\n        * getLeftPositionAndPath\n        */\n        function getLeftPositionAndPath (tooltipPositionObj, containerHeight)\n        {\n          var path;\n          var translate;\n          var translateX;\n          var translateY;\n\n          translateY = getPathTranslate(\n            tooltipPositionObj.hittingBottom,\n            tooltipPositionObj.hittingTop,\n            (tooltipPositionObj.centerY - _Chart.config('padding')),\n            'height',\n            containerHeight\n          );\n\n          translateX = tooltipPositionObj.leftX;\n          translate = _Chart._leftPath.translate;\n\n          if (_Chart._moveY !== 0) {\n            path = updateCaretPath('_leftPath', 'y');\n          }\n          else {\n            path = _Chart._leftPath.path;\n          }\n\n          return {translateX: translateX, translateY: translateY, translate: translate, path: path};\n        }\n\n\n        /**\n         * Returns the tooltips draw position and path given the current draw location.\n         *\n         * @param location\n         * @param tooltipPositionObj\n         * @param containerHeight\n         * @returns {{translateX: *, translateY: *, translate: *, path: *}}\n         */\n        function calPositionAndPath(location, tooltipPositionObj, containerHeight, containerWidth) {\n\n          var positionAndPath;\n\n          switch (location) {\n            case 'top':{\n              positionAndPath = getTopLocationsAndPath(tooltipPositionObj, containerWidth);\n              break;\n            }\n            case 'right': {\n              positionAndPath = getRightPositionAndPath(tooltipPositionObj, containerHeight);\n              break;\n            }\n            case 'bottom': {\n              positionAndPath = getBottomPositionAndPath(tooltipPositionObj, containerWidth);\n              break;\n            }\n            case 'left': {\n              positionAndPath = getLeftPositionAndPath(tooltipPositionObj, containerHeight);\n              break;\n            }\n          }\n\n          return positionAndPath;\n        }\n\n\n        /**\n         * Determine the direction the tooltip should draw given its location.\n         * @param tooltipPositionObj\n         * @returns {string}\n         */\n        function determineInboundsTooltipLocation(tooltipPositionObj) {\n\n          var location = 'top';\n          if ((tooltipPositionObj.hittingRight || tooltipPositionObj.hittingLeft) && !tooltipPositionObj.closeToTop) {\n            location = 'top';\n          }\n          else if ((tooltipPositionObj.hittingRight || tooltipPositionObj.hittingLeft) && tooltipPositionObj.closeToTop) {\n            location = 'bottom';\n          }\n          else if (tooltipPositionObj.hittingTop && tooltipPositionObj.closeToRight) {\n            location = 'left';\n          }\n          else if (tooltipPositionObj.hittingTop && tooltipPositionObj.closeToLeft) {\n            location = 'right';\n          }\n          else if (!tooltipPositionObj.hittingRight && tooltipPositionObj.closeToRight) {\n            location = 'left';\n          }\n          else if (!tooltipPositionObj.hittingLeft && tooltipPositionObj.closeToLeft) {\n            location = 'right';\n          }\n          else if (tooltipPositionObj.closeToBottom && tooltipPositionObj.closeToTop) {\n            location = 'top';\n          }\n          else if (tooltipPositionObj.closeToTop) {\n            location = 'bottom';\n          }\n\n          return location;\n        }\n\n\n        /**\n         * getTooltipPositionStatus\n         */\n        function getTooltipPositionStatus(containerWidth, containerHeight, point) {\n          var rectBBox = _Chart._gBBox;\n\n          var offsetY = point.y - _Chart._baseGroupBBox.height;\n          var offsetX = point.x - _Chart._baseGroupBBox.width / 2;\n          var offsetPadding = _Chart._caretWidth;\n\n          var topY    = offsetY - offsetPadding;\n          var bottomY = point.y + offsetPadding;\n          var centerY = point.y - rectBBox.height / 2;\n          var leftX   = point.x - _Chart._baseGroupBBox.width - _Chart.config('caretSize');\n          var rightX  = point.x + offsetPadding + 5;\n\n          var closeToRight = point.x + _Chart._baseGroupBBox.width / 2 >= containerWidth;\n          var closeToLeft = point.x - _Chart._baseGroupBBox.width / 2 <= 0;\n          var closeToTop = point.y - _Chart._baseGroupBBox.height - offsetPadding - 3 <= 0;\n          var closeToBottom = point.y + _Chart._baseGroupBBox.height > containerHeight;\n\n          var hittingRight  = closeToRight && point.x - _Chart._baseGroupBBox.width - offsetPadding <= 0;\n          var hittingLeft   = closeToLeft && point.x + _Chart._baseGroupBBox.width + offsetPadding >= containerWidth;\n          var hittingTop    = (closeToRight || closeToLeft) && (point.y - (_Chart._baseGroupBBox.height / 2) <= 0);\n          var hittingBottom = (closeToRight || closeToLeft) && (point.y + (_Chart._baseGroupBBox.height / 2) >= containerHeight);\n\n          return {\n            offsetX: offsetX,\n            topY: topY,\n            bottomY: bottomY,\n            centerY: centerY,\n            leftX: leftX,\n            rightX: rightX,\n            closeToRight: closeToRight,\n            closeToLeft: closeToLeft,\n            closeToTop: closeToTop,\n            closeToBottom: closeToBottom,\n            hittingRight: hittingRight,\n            hittingLeft: hittingLeft,\n            hittingTop: hittingTop,\n            hittingBottom: hittingBottom\n          };\n        }\n\n\n        /**\n         * SetBaseGroupBBoxDimensions\n         * @param location position of the tooltip\n         */\n        function setBaseGroupBBoxDimensions(location) {\n          _Chart._baseGroupBBox.height =\n            location === 'top' || location === 'bottom' ?\n            _Chart._gBBox.height + (_Chart.config('padding') * 2) + _Chart.config('caretSize') + 6 :\n            _Chart._gBBox.height + (_Chart.config('padding') * 2) + 6;\n\n          _Chart._baseGroupBBox.width =\n            location === 'top' || location === 'bottom' ?\n            _Chart._gBBox.width + (_Chart.config('padding') * 2) + 6 :\n            _Chart._gBBox.width + (_Chart.config('padding') * 2) + _Chart.config('caretSize') + 6;\n        }\n\n\n\n\n\n        /*----------------------------------------------------------------------------------\n        // Helper Functions\n        ----------------------------------------------------------------------------------*/\n\n        /**\n         * Returns if appends is in text rect text format\n         * @param appends\n         * @returns {boolean}\n         */\n        function isTextRectText(appends) {\n          var returnVal = true;\n          for (var i = 0; i < appends.node().childNodes.length; i++) {\n            var nodeName = appends.node().childNodes[i].nodeName;\n            returnVal = (i % 2 === 0 && nodeName === 'text' ? true : (nodeName === 'rect'));\n            if (!returnVal) { break;}\n          }\n          return returnVal;\n        }\n\n        /**\n         * Formats appends as text rect text\n         * @param appends\n         * @param groupBBox\n         */\n        function formatAppendTextRectText(appends) {\n          var padding = 5;\n          var prevWidth = 0;\n          var groupBBox = {x:0,y:0,height:0,width:0};\n\n          appends.select('rect').attr('height', 0);\n          groupBBox = appends.node().getBBox();\n\n\n          /*jshint -W083 */\n          for (var i = 0; i < appends.node().childNodes.length; i++) {\n            var element = appends.node().childNodes[i];\n\n            if (i % 2 === 0) {\n              //text\n              var t = appends.select('text:nth-child(' + (i + 1) + ')')\n                .attr({\n                  dy: function () {return getCentralPosition(this);},\n                  x: (prevWidth + (padding * i) + 1),\n                  y: groupBBox.height / 2\n                });\n\n              prevWidth += element.getBBox().width;\n\n            }\n            else {\n              //rect\n              appends.select('rect:nth-child(' + (i + 1) + ')')\n                .attr({\n                  x: (prevWidth + (padding * i)),\n                  y: 0,\n                  width: 1,\n                  height: groupBBox.height\n                });\n            }\n          }\n\n          appends.selectAll('tspan')\n            .attr({\n              transform: function () { return 'translate(0, ' + getCentralPosition(this) + ')'; },\n              y: groupBBox.height / 2\n            });\n        }\n\n\n        /**\n         * setBaseGroupBBox\n         */\n        function setBaseGroupBBox() {\n          _Chart._baseGroupBBox = cloneBBox(_Chart._baseGroup.node().getBBox());\n          _Chart._baseGroupBBox.height = _Chart._baseGroupBBox.height - _Chart._caretWidth + 3;\n        }\n\n\n        /**\n         * Set gBBox's height and width to height, width if defined else\n         * it will use appends BBox.\n         * @param height\n         * @param width\n         */\n        function setGBBox(height, width) {\n          if (height !== undefined && width !== undefined) {\n            _Chart._gBBox = {\n              'height': height,\n              'width': width\n            };\n          }\n          else {\n            _Chart._gBBox = _Chart._appends.node().getBBox();\n          }\n        }\n\n\n        /**\n         * Calculates vertical center for text\n         * @param elem\n         * @returns {number}\n         */\n        function getCentralPosition(elem) {\n          return parseInt(d3.select(elem)\n              .style('font-size'), 10) * 0.35;\n        }\n\n        /**\n         * Returns a tranlate that keeps the path in bounds.\n         * @param hittingEdge1\n         * @param hittingEdge2\n         * @param offset\n         * @param dimension\n         * @param heightOrWidth\n         * @returns {*}\n         */\n        function getPathTranslate(hittingEdge1, hittingEdge2, offset, dimension, heightOrWidth) {\n          var translate;\n\n          if (hittingEdge1) {\n            translate = heightOrWidth - _Chart._baseGroupBBox[dimension] + r;\n          }\n          else if (hittingEdge2) {\n            translate = r;\n          }\n          else {\n            translate = offset;\n          }\n\n          return translate;\n        }\n\n        /**\n         * UpdateCaretPath\n         * @param path\n         * @param axis\n         * @returns {.autoshot.default_options.options.path|*|.autoshot.default_options.options.local.path|options.path|options.local.path|path}\n         */\n        function updateCaretPath(path, axis) {\n          var pathString;\n          var xyString;\n\n          if (axis === 'y') {\n            xyString = _Chart[path].caretX + ' ' + (_Chart[path].caretY - _Chart._moveY);\n          }\n          else {\n            xyString = (_Chart[path].caretX + _Chart._moveX) + ' ' + _Chart[path].caretY;\n          }\n\n          pathString = _Chart[path].path.match(/Z m (.*?) l/);\n          _Chart[path].path = _Chart[path].path.replace(pathString[1], xyString);\n          return _Chart[path].path;\n        }\n\n\n        /**\n         * OffsetCaretAtEdge\n         * @param config\n         */\n        function offsetCaretAtEdge(config) {\n          var container = config.container;\n          var point = config.point;\n          var tooltipWidth;\n          var tooltipHeight;\n          var bboxWidth;\n          var bboxHeight;\n          var mouseXOffset = container.width - point.x;\n          var mouseYOffset = point.y;\n\n          var curvedRectOffset = 2*r; //Compensate for the curved rect path. 1 is for good measure.\n\n          bboxHeight = _Chart._gBBox.height; // - curvedRectOffset;\n          bboxWidth  = _Chart._gBBox.width; //  - curvedRectOffset;\n\n\n          var farthestCaretPosition;\n\n          if (config.left || config.right) {\n\n            //Left\n            if (config.left) {\n              tooltipWidth = container.width - (_Chart._baseGroupBBox.width / 2);\n              _Chart._moveX = tooltipWidth - mouseXOffset;\n\n              if ((bboxWidth / 2) + _Chart.config('caretSize') <= _Chart._moveX) {\n                _Chart._moveX = -((bboxWidth / 2) + _Chart.config('caretSize'));\n              }\n            }\n\n            //Right\n            if (config.right) {\n              tooltipWidth = _Chart._baseGroupBBox.width / 2;\n              _Chart._moveX = tooltipWidth - mouseXOffset;\n\n              if (-((bboxWidth / 2) + _Chart.config('caretSize')) >= _Chart._moveX) {\n                _Chart._moveX = -((bboxWidth / 2) + _Chart.config('caretSize'));\n              }\n            }\n\n\n          }\n          else if (config.top || config.bottom) {\n\n            //Top\n            if (config.top) {\n              tooltipHeight = _Chart._baseGroupBBox.height / 2;\n              _Chart._moveY = tooltipHeight - mouseYOffset;\n\n              farthestCaretPosition = (bboxHeight / 2) + _Chart.config('caretSize') - curvedRectOffset;\n\n              if (farthestCaretPosition <= _Chart._moveY) {\n                _Chart._moveY = farthestCaretPosition;\n              }\n            }\n\n            //Bottom\n            if (config.bottom) {\n              tooltipHeight = container.height - ((_Chart._baseGroupBBox.height) / 2);\n              _Chart._moveY = tooltipHeight - mouseYOffset;\n\n              farthestCaretPosition = -(((bboxHeight) / 2) - _Chart.config('caretSize')) - curvedRectOffset;\n\n              if (farthestCaretPosition >= _Chart._moveY) {\n                _Chart._moveY = farthestCaretPosition;\n              }\n            }\n          }\n          else {\n            _Chart._moveX = 0;\n            _Chart._moveY = 0;\n          }\n        }\n\n\n        /**\n         * GeneratePaths\n         */\n        function generatePaths() {\n          var w = _Chart._gBBox.width + (_Chart.config('padding') * 2);\n          var h = _Chart._gBBox.height + (_Chart.config('padding') * 2);\n          var c = _Chart.config('caretSize');\n          var y = (h / 2) + _Chart.config('caretSize') + r;\n\n          _Chart._topPath = {\n            translate: 'translate(' + (w / 2) + ',' + (h + c + r) + ')',\n            caretX: ((w / 2) - c),\n            caretY: (h + (r * 2))\n          };\n          _Chart._topPath.path = 'm -' + (w / 2) + ' -' + (h + c + (r * 2)) +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._topPath.caretX + ' ' + _Chart._topPath.caretY +\n          ' l ' + c + ' ' + c +\n          ' l ' + c + ' -' + c;\n\n          _Chart._bottomPath = {\n            translate: 'translate(' + (w / 2) + ',' + (-c + (r / 2)) + ')',\n            caretX: ((w / 2) - c),\n            caretY: 0\n          };\n          _Chart._bottomPath.path = 'm -' + (w / 2) + ' ' + 0 +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._bottomPath.caretX + ' ' + _Chart._bottomPath.caretY +\n          ' l ' + c + ' -' + c +\n          ' l ' + c + ' ' + c;\n\n          _Chart._leftPath = {\n            translate: 'translate(' + (w + c + r) + ',' + (h / 2) + ')',\n            caretX: (w + r),\n            caretY: y\n          };\n          _Chart._leftPath.path = 'm -' + (w + c + r) + ' ' + -((h / 2) + r) +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._leftPath.caretX + ' ' + _Chart._leftPath.caretY +\n          ' l ' + c + ' -' + c +\n          ' l -' + c + ' -' + c;\n\n          _Chart._rightPath = {\n            translate: 'translate(' + -(c + r) + ',' + (h / 2) + ')',\n            caretX: -r,\n            caretY: y\n          };\n          _Chart._rightPath.path = 'm ' + (c + r) + ' ' + -((h / 2) + r) +\n          ' h ' + w +\n          ' c 1.7 0 ' + r + ' 1.3 ' + r + ' ' + r +\n          ' v ' + h +\n          ' c 0 1.7 -1.3 ' + r + ' -' + r + ' ' + r +\n          ' h -' + w +\n          ' c -1.7 0 -' + r + ' -1.3 -' + r + ' -' + r +\n          ' v -' + h +\n          ' c 0 -1.7 1.3 -' + r + ' ' + r + ' -' + r +\n          ' Z m ' + _Chart._rightPath.caretX + ' ' + _Chart._rightPath.caretY +\n          ' l -' + c + ' -' + c +\n          ' l ' + c + ' -' + c + ' Z';\n        }\n\n        /**\n         * cloneBBox, IE will not let you modify the obj returned from getBBox\n         * @param box\n         * @returns {{x: *, y: *, width: *, height: *}}\n         */\n        function cloneBBox(box) {\n          return {\n            x: box.x,\n            y: box.y,\n            width: box.width,\n            height: box.height\n          };\n        }\n    }\n    preDraw(){\n      this._container = this.config('container');\n    }\n  }\n\n  var _Tooltip = Tooltip;\n\n  /**\n   * This will convert a flat, 2D array into a nested data structure.\n   * Simular to d3.nest but allows n number of depths for each node\n   */\n\n  // jscs:disable\n  function hierarchy () {\n    var nest = {},\n        keys = [],\n        sortKeys = [],\n        maxLength = 0,\n        sortValues,\n        rollup,\n        filter = function (d) {\n          return d !== null;\n        };\n\n   function keySetter (depth) {\n      return function (d) {\n        return d[depth];\n      };\n    }\n\n    function map(mapType, array, depth) {\n      if (depth >= maxLength) {\n        return rollup\n          ? rollup.call(nest, array) : (sortValues\n          ? array.sort(sortValues)\n          : array);\n      }\n\n      var i = -1,\n          n = array.length,\n          key = keySetter(depth++),\n          keyValue,\n          object,\n          setter,\n          size,\n          valuesByKey = d3.map({}),\n          values;\n\n      /*jshint -W084 */\n      while (++i < n) {\n        if (depth === 1) {\n          object = array[i].filter(filter);\n        } else {\n          object = array[i];\n        }\n        values = valuesByKey.get(keyValue = key(object));\n        if (array[i].length > depth) {\n          if (values) {\n            values.push(object);\n          } else {\n            valuesByKey.set(keyValue, [object]);\n          }\n        }\n      }\n\n      if (mapType) {\n        object = mapType();\n        size = function (object) {\n          return object.size();\n        };\n        setter = function(keyValue, values) {\n          object.set(keyValue, map(mapType, values, depth));\n        };\n      } else {\n        object = {};\n        size = function (object) {\n          return Object.keys(object).length;\n        };\n        setter = function(keyValue, values) {\n          object[keyValue] = map(mapType, values, depth);\n        };\n      }\n\n      valuesByKey.forEach(setter);\n      if (!size(object)) {\n        return array;\n      }\n      return object;\n    }\n\n    function entries(map, depth) {\n      if (depth >= maxLength || depth > map.length - 1) {\n        return map;\n      }\n\n      var array = [],\n          sortKey = sortKeys[depth++];\n\n      map.forEach(function(key, keyMap) {\n        array.push({name: key, children: entries(keyMap, depth)});\n      });\n\n      return sortKey\n        ? array.sort(function(a, b) { return sortKey(a.name, b.name); })\n        : array;\n    }\n\n    nest.map = function(array, mapType) {\n      return map(mapType, array, 0);\n    };\n\n    nest.entries = function(array) {\n      return entries(map(d3.map, array, 0), 0);\n    };\n\n    nest.maxLength = function(newMaxLength) {\n      maxLength = newMaxLength - 2;\n      return nest;\n    };\n\n    nest.filter = function (f) {\n      filter = f;\n      return nest;\n    };\n\n    // Specifies the order for the most-recently specified key.\n    // Note: only applies to entries. Map keys are unordered!\n    nest.sortKeys = function(order, depth) {\n      depth = depth || maxLength;\n      sortKeys[depth] = order;\n      return nest;\n    };\n\n    // Specifies the order for leaf values.\n    // Applies to both maps and entries array.\n    nest.sortValues = function(order) {\n      sortValues = order;\n      return nest;\n    };\n\n    nest.rollup = function(f) {\n      rollup = f;\n      return nest;\n    };\n\n    return nest;\n  }\n  // jscs:enable\n\n  var _hierarchy = hierarchy;\n\n  class Icicle extends koto.Base {\n  \tconstructor(selection) {\n      super(selection);\n      var _Chart = this;\n\n      [{\n        name: 'height',\n        description: 'The height of the chart.',\n        value: 700,\n        type: 'number',\n        units: 'px',\n        category: 'Size',\n        getter: function (){\n          // get value\n          console.log('getter');\n          return this.value;\n        },\n        setter: function (newValue){\n          // Set something\n          console.log('setter');\n          return newValue;\n        }\n      }, {\n        name: 'width',\n        description: 'The widthj of the chart.',\n        value: 900,\n        units: 'px',\n        type: 'number',\n        category: 'Size'\n      }, {\n        name: 'transitionDuration',\n        description: 'How long should it take to animate on click.',\n        value: 750,\n        units: 'ms',\n        type: 'number',\n        category: 'Animation'\n      }, {\n        name: 'introDuration',\n        description: 'How long should it take to animate in.',\n        value: 2000,\n        units: 'ms',\n        type: 'number',\n        category: 'Animation'\n      }, {\n        name: 'colorRange',\n        value: ['#BBE491', '#FB8D34', '#E45621', '#73B0D7'],\n        description: 'colors for categories',\n        type: 'colorArray',\n        category: 'Color'\n      }].forEach(function (item) {\n        _Chart.configs.set(item.name, item);\n      });\n\n      // accessors\n      this.accessor('name', function (d) { return d[d.length-2]; });\n\n      // formatters\n      var percent = d3.format('%');\n      var overUnder = d3.format('+%');\n\n      // scales\n      this.x = d3.scale.linear();\n      this.y = d3.scale.linear();\n      this.color = d3.scale.ordinal();\n\n      // layouts\n      this.partition = d3.layout.partition()\n        .value(function(d) { return d[d.length - 1]; });\n\n      // setup main group\n      this._group = this.base.append('g');\n      \n      // Set up tool tip;\n      this._tooltip = new _Tooltip(this.base.append('g'));\n\n      this._tooltip.config({\n        opacity: 1,\n        format: 'textRectText'\n      });\n\n      this._tooltipValue = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      this._tooltipRect = this._tooltip._appends.append('rect');\n      this._tooltipLabel = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      \n      this._tooltip.trigger('draw');\n      this._tooltip.trigger('remove');\n      \n      // Setup Layers\n      var icicle = this.layer('icicle', this._group, {\n        dataBind: function (data) {\n          var root = _Chart.partition(data[0]);\n          if (_Chart._targetData) {\n            var target = _Chart.partition(_Chart._targetData[0]);\n            for (var i=0; i < root.length; i++) {\n              root[i].target = target[i].value;\n            }\n          }\n          return this.selectAll('g').data(root);\n        },\n        insert: function () {\n          return this.append('g')\n            .on('click', click)\n            .on('mouseover', function (d) {\n              _Chart._group.selectAll('rect')\n                .filter(function (datum) {\n                  var thingName = d.name ? d.name : d[d.length - 2];\n                  return !isRelated(d, datum);\n                })\n                .style('fill', '#e3e3e3');\n\n                _Chart._tooltipValue\n                  .text(d.name ? d.name : _Chart.accessor('name')(d));\n\n                _Chart._tooltipRect.style('fill', '#000');\n\n                _Chart._tooltipLabel\n                  .text(percent(d.value));\n\n                if (_Chart._targetData) {\n                  _Chart._tooltipRect2.style('fill', '#000');\n                  _Chart._tooltipLabel2\n                    .text(overUnder(d.value - d.target));\n                }\n\n                _Chart._tooltip.trigger('draw');\n              })\n              .on('mousemove', function () {\n                var coordinates = d3.mouse(_Chart.base.node());\n                _Chart._tooltip.trigger('moveTo', {x: coordinates[0], y: coordinates[1]}, null, _Chart.config('width'), _Chart.config('height'));\n              })\n              .on('mouseout', function (d) {\n                _Chart._group.selectAll('rect')\n                  .style('fill', function(d) { return _Chart.color(d.base); });\n\n                _Chart._tooltip.trigger('remove');\n              });\n        }\n      });\n    \n      // layer life-cycle events\n      icicle.on('enter', function () {\n        this.append('rect')\n          .style('stroke', '#fff');\n        \n        if (_Chart._targetData) {\n          this.append('path');\n        }\n\n        this.append('text')\n          .style('pointer-events', 'none');\n\n        return this;\n      })\n      .on('merge', function () {\n        // boxes\n        this.selectAll('rect')\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.dx); })\n          .attr('height', 0)\n          .style('fill', function(d) { d.base = getParent(d, _Chart.rootName); return _Chart.color(d.base); });\n\n        // over-under indicator\n        if (_Chart._targetData) {\n          this.selectAll('path')\n            .style('fill', '#555')\n            .style('opacity', 0)\n            .attr({\n              d: function (d) {\n                var symbol = d3.svg.symbol();\n                var gen = d.value > d.target ? symbol.type('triangle-up') : d.value < d.target ? symbol.type('triangle-down') : symbol.type('triangle-down');\n                return gen();\n              },\n              transform: function (d) {\n                var left = _Chart.x(d.x) + 15;\n                var top = _Chart.y(d.y) + 15;\n                \n                return `translate(${left},${top})`;\n              }\n            });\n        }\n\n        // labels\n        this.selectAll('text')\n          .text(function (d) { return d.name ? d.name : d[d.length - 2]; })\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('dx', _Chart._targetData ? 25 : 5)\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('dy', 16)\n          .style('alignment-baseline', 'middle')\n          .style('fill', '#555')\n          .style('font-family', 'Open Sans')\n          .style('opacity', 0);\n      })\n      .on('merge:transition', function () {\n        var totalDuration = _Chart.config('introDuration');\n        var duration = totalDuration/(_Chart.max-1);\n        \n        // rects\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .selectAll('rect')\n          .attr('height', function(d) { return _Chart.y(d.dy); });\n        \n        // paths\n        if (_Chart._targetData) {\n          this\n            .delay(totalDuration)\n            .selectAll('path')\n            .style('opacity', function (d) {\n              var shouldShow = d.value > d.target || d.value < d.target;\n              var canFit = _Chart.x(d.dx) > 25;\n              return shouldShow && canFit ? 1 : 0;\n            });\n        }\n\n        // linear\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .selectAll('text')\n          .style('opacity', function (d) {\n            d.textLength = this.getComputedTextLength();\n            return (d.textLength + 30) < _Chart.x(d.dx) ? 1 : 0;\n          });\n        return this;\n      });\n\n      // click event handler\n      function click(d) {\n        _Chart.x.domain([d.x, d.x + d.dx]);\n        _Chart.y.domain([d.y, 1]).range([d.y ? 20 : 0, _Chart.config('height')]);\n\n        // transition Rects\n        _Chart._group.selectAll('rect')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.x + d.dx) - _Chart.x(d.x); })\n          .attr('height', function(d) { return _Chart.y(d.y + d.dy) - _Chart.y(d.y); });\n\n        // transition paths\n        if (_Chart._targetData) {\n          _Chart._group.selectAll('path')\n            .transition()\n            .duration(_Chart.config('transitionDuration'))\n            .attr('transform', function (d) {\n              var left = _Chart.x(d.x) + 15;\n              var top = _Chart.y(d.y) + 15;\n              return `translate(${left},${top})`;\n            });\n        }\n\n        // transition text\n        _Chart._group.selectAll('text')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .style('opacity', function (d) {\n            return (d.textLength + 12) < (_Chart.x(d.x + d.dx) - _Chart.x(d.x)) ? 1 : 0;\n          });\n      }\n\n      // check to see if nodes are related\n      function isRelated(thing, relative) {\n        return (isChild(thing, relative) || isParent(thing, relative));\n      }\n\n      // check to see if node is child\n      function isChild(thing, relative) {\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.parent) {\n          return false;\n        }\n        return isChild(thing.parent, relative);\n      }\n\n      // check to see if node is parent\n      function isParent (thing, relative) {\n        var i;\n        var temp;\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.children) {\n          return false;\n        }\n        for (i=0; i < thing.children.length; i++) {\n          if (isParent(thing.children[i], relative)) {\n            return true;\n          }\n        }\n        return false;\n      }\n\n      // get parents name - for color\n      function getParent (d, rootName) {\n        if (!d.parent) {\n          return d.name;\n        }\n        if (d.parent.name === rootName) {\n          return d.name;\n        }\n        return getParent(d.parent, rootName);\n      }\n    }\n\n    transform(data){\n      this.max = d3.max(data, function (row) { return row.length; });\n      return _hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n    }\n\n    targetData(data){\n      this._targetData = _hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n\n      this._tooltipRect2 = this._tooltip._appends.append('rect');\n      this._tooltipLabel2 = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      return this;\n    }\n\n    preDraw(data){\n      this.x.range([0, this.config('width')]);\n      this.y.range([0, this.config('height')]);\n      this.rootName = data[0].name;\n      \n      var level1 = data[0].children.map(function (child) { return child.name; });\n      level1.push(this.rootName);\n      this.color.range(this.config('colorRange')).domain(level1);\n    }\n  }\n\n  koto.Icicle = Icicle;\n\n  var chart = koto.Icicle;\n\n  return chart;\n\n}));\n"]}